---
interface Props {
  name: string;
  company: string;
  slug: string;
  status: 'released' | 'beta' | 'alpha' | 'waitlist' | 'research';
  shortDescription: string;
  categories: string[];
  pricing: {
    model: string;
    startingPrice?: string;
  };
  capabilities: {
    maxResolution: string;
    maxDuration: string;
  };
  quality: {
    outputQuality: number;
    consistency: number;
    speed: number;
  };
  featured?: boolean;
}

const { 
  name, 
  company, 
  slug, 
  status, 
  shortDescription, 
  categories, 
  pricing, 
  capabilities,
  quality,
  featured = false 
} = Astro.props;

// Status badge styling
const statusStyles: Record<string, string> = {
  released: 'badge-released',
  beta: 'badge-beta',
  alpha: 'badge-alpha',
  waitlist: 'badge-waitlist',
  research: 'badge-research',
};

// Category display names
const categoryNames: Record<string, string> = {
  'text-to-video': 'Text-to-Video',
  'image-to-video': 'Image-to-Video',
  'video-to-video': 'Video-to-Video',
  'animation': 'Animation',
};

// Render star rating
const renderStars = (rating: number) => {
  return Array.from({ length: 5 }, (_, i) => 
    i < rating ? '★' : '☆'
  ).join('');
};
---

<article class="card group relative overflow-hidden" data-model-slug={slug}>
  <!-- Favorite Button -->
  <button 
    class="favorite-btn absolute top-4 left-4 z-10 p-2 rounded-full bg-slate-800/80 hover:bg-slate-700 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100"
    aria-label={`Add ${name} to favorites`}
    data-slug={slug}
    data-name={name}
  >
    <svg class="w-5 h-5 favorite-icon text-slate-400 hover:text-red-400 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
    </svg>
    <svg class="w-5 h-5 favorite-icon-filled text-red-500 hidden" fill="currentColor" viewBox="0 0 24 24">
      <path d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
    </svg>
  </button>
  
  <!-- Featured Badge -->
  {featured && (
    <div class="absolute top-4 right-4 z-10">
      <span class="px-2 py-1 text-xs font-semibold rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 text-white">
        Featured
      </span>
    </div>
  )}
  
  <!-- Card Content -->
  <a href={`/models/${slug}`} class="block p-6">
    <!-- Header -->
    <div class="mb-4">
      <div class="flex items-start justify-between gap-4 mb-2">
        <div>
          <h3 class="text-xl font-bold text-white group-hover:text-indigo-400 transition-colors">
            {name}
          </h3>
          <p class="text-slate-400 text-sm">{company}</p>
        </div>
        <span class={`badge ${statusStyles[status]}`}>
          {status}
        </span>
      </div>
    </div>
    
    <!-- Description -->
    <p class="text-slate-300 text-sm mb-4 line-clamp-2">
      {shortDescription}
    </p>
    
    <!-- Categories -->
    <div class="flex flex-wrap gap-2 mb-4">
      {categories.map((category) => (
        <span class="tag">
          {categoryNames[category] || category}
        </span>
      ))}
    </div>
    
    <!-- Capabilities -->
    <div class="grid grid-cols-2 gap-4 mb-4 py-4 border-t border-b border-slate-700/50">
      <div>
        <p class="text-slate-500 text-xs uppercase tracking-wider mb-1">Resolution</p>
        <p class="text-white font-medium">{capabilities.maxResolution}</p>
      </div>
      <div>
        <p class="text-slate-500 text-xs uppercase tracking-wider mb-1">Duration</p>
        <p class="text-white font-medium">{capabilities.maxDuration}</p>
      </div>
    </div>
    
    <!-- Quality Ratings -->
    <div class="mb-4">
      <div class="grid grid-cols-3 gap-2 text-sm">
        <div>
          <p class="text-slate-500 text-xs mb-1">Quality</p>
          <p class="text-yellow-400">{renderStars(quality.outputQuality)}</p>
        </div>
        <div>
          <p class="text-slate-500 text-xs mb-1">Consistency</p>
          <p class="text-yellow-400">{renderStars(quality.consistency)}</p>
        </div>
        <div>
          <p class="text-slate-500 text-xs mb-1">Speed</p>
          <p class="text-yellow-400">{renderStars(quality.speed)}</p>
        </div>
      </div>
    </div>
    
    <!-- Pricing -->
    <div class="flex items-center justify-between">
      <div>
        <p class="text-slate-500 text-xs uppercase tracking-wider mb-1">Starting at</p>
        <p class="text-white font-semibold">
          {pricing.startingPrice || 'Free'}
        </p>
      </div>
      <div class="flex items-center gap-2 text-indigo-400 group-hover:text-indigo-300 transition-colors">
        <span class="text-sm font-medium">Learn more</span>
        <svg class="w-4 h-4 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </div>
    </div>
  </a>
</article>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .favorite-btn[aria-pressed="true"] .favorite-icon {
    display: none;
  }
  
  .favorite-btn[aria-pressed="true"] .favorite-icon-filled {
    display: block;
  }
  
  .favorite-btn[aria-pressed="true"] {
    opacity: 1 !important;
  }
</style>
